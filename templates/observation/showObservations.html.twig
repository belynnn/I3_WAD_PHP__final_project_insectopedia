{% extends 'base.html.twig' %}

{% block title %}Observations{% endblock %}

{% block body %}
    <h1 class="bg-gradient-green mb-3 px-4 pb-2 pt-2 text-white">Observations</h1>

    <ul>
        <li>Carte</li>
        <li>Liste</li>
    </ul>

    <style>
        #map {
            width: 100%;
            height: 540px;
        }
    </style>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
        crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""></script>

    <div id="map"></div>

    <script>
        var map = L.map('map').setView([50.499527, 4.475403], 8);

        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map);

        // Ajout des marqueurs dynamiquement
        {% for observation in observations %}
            {% if observation.latitude is not null and observation.longitude is not null %}
                var marker = L.marker([{{ observation.latitude }}, {{ observation.longitude }}]).addTo(map);
                marker.bindTooltip("{{ observation.nameInsect }}<br>{{ observation.dateObservation|date('d/m/Y') }}");
            {% endif %}
        {% endfor %}
    </script>

    <div class="container text-center">
        <div class="row row-cols-3">

            {% for observation in observations %}
                <div class="col">
                    <a href="{{ path ('app_observation',   {id: observation.id}) }}">{{ observation.nameInsect }}</a>

                    {% if observation.photo is not null and observation.photo != 'null' %}
                        <div><img src="../uploads/photos/{{ observation.photo }}" width="250px" height="250px" /></div>
                    {% else %}
                        <div><img src="https://answers-afd.microsoft.com/static/images/image-not-found.jpg" width="250px" /></div>
                    {% endif %}
                </div>

            {% else %}
                Aucune observation trouv√©e.
            {% endfor %}
        </div>
    </div>

    <script>

    </script>
{% endblock %}
